<div class="container" style="max-width: 500px; margin: 4rem auto;">
    <div class="card">
        <div class="card-header">
            <h2 class="card-title">Create Account</h2>
        </div>
        <div class="card-body">
            <form id="registerForm">
                <div class="form-group">
                    <label class="form-label required" for="regName">Full Name</label>
                    <input 
                        type="text" 
                        id="regName" 
                        class="form-input" 
                        placeholder="Enter your full name"
                        required
                    >
                    <div class="form-error" id="nameError"></div>
                </div>

                <div class="form-group">
                    <label class="form-label required" for="regEmail">Email</label>
                    <input 
                        type="email" 
                        id="regEmail" 
                        class="form-input" 
                        placeholder="Enter your email"
                        required
                        autocomplete="email"
                    >
                    <div class="form-error" id="regEmailError"></div>
                </div>

                <div class="form-group">
                    <label class="form-label required" for="regPassword">Password</label>
                    <input 
                        type="password" 
                        id="regPassword" 
                        class="form-input" 
                        placeholder="Enter your password (min 6 characters)"
                        required
                        autocomplete="new-password"
                        minlength="6"
                    >
                    <div class="form-error" id="regPasswordError"></div>
                </div>

                <div class="form-group">
                    <label class="form-label required" for="regRole">Role</label>
                    <select id="regRole" class="form-select" required>
                        <option value="">Select your role</option>
                        <option value="student">Student</option>
                        <option value="club_representative">Club Representative</option>
                        <option value="admin">Admin</option>
                    </select>
                    <div class="form-error" id="roleError"></div>
                </div>

                <div class="form-group">
                    <button type="submit" class="btn btn-primary" style="width: 100%;">
                        <i class="fas fa-user-plus"></i>
                        Create Account
                    </button>
                </div>

                <div class="text-center" style="margin-top: 1rem;">
                    <p style="color: var(--text-secondary);">
                        Already have an account? 
                        <a href="#login" onclick="loadPage('login')" style="color: var(--primary-color); text-decoration: none;">
                            Login here
                        </a>
                    </p>
                </div>
            </form>
        </div>
    </div>
</div>

<script>
// Define function in global scope
window.setupRegisterForm = function() {
    const form = document.getElementById('registerForm');
    if (form) {
        // Remove existing listeners
        const newForm = form.cloneNode(true);
        form.parentNode.replaceChild(newForm, form);
        
        newForm.addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const name = document.getElementById('regName').value.trim();
            const email = document.getElementById('regEmail').value.trim();
            const password = document.getElementById('regPassword').value;
            const role = document.getElementById('regRole').value;
            
            // Clear previous errors
            ['nameError', 'regEmailError', 'regPasswordError', 'roleError'].forEach(id => {
                const el = document.getElementById(id);
                if (el) el.textContent = '';
            });
            
            // Validation
            let hasError = false;
            
            if (!name) {
                const el = document.getElementById('nameError');
                if (el) el.textContent = 'Name is required';
                hasError = true;
            }
            
            if (!email) {
                const el = document.getElementById('regEmailError');
                if (el) el.textContent = 'Email is required';
                hasError = true;
            } else if (typeof validateEmail === 'function' && !validateEmail(email)) {
                const el = document.getElementById('regEmailError');
                if (el) el.textContent = 'Please enter a valid email';
                hasError = true;
            }
            
            if (!password) {
                const el = document.getElementById('regPasswordError');
                if (el) el.textContent = 'Password is required';
                hasError = true;
            } else if (password.length < 6) {
                const el = document.getElementById('regPasswordError');
                if (el) el.textContent = 'Password must be at least 6 characters';
                hasError = true;
            }
            
            if (!role) {
                const el = document.getElementById('roleError');
                if (el) el.textContent = 'Role is required';
                hasError = true;
            }
            
            if (hasError) return;
            
            if (typeof handleRegister === 'function') {
                await handleRegister({ name, email, password, role });
            } else {
                console.error('handleRegister function not found');
                showToast('error', 'Error', 'Registration function not available. Please refresh the page.');
            }
        });
    }
};

// Execute immediately
if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', window.setupRegisterForm);
} else {
    window.setupRegisterForm();
}
</script>

